<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:WorldBuilder.Editors.Landscape.ViewModels"
             xmlns:models="using:WorldBuilder.Shared.Models"
             x:Class="WorldBuilder.Editors.Landscape.Views.BiomePainterSubToolView"
             x:DataType="vm:BiomePainterSubToolViewModel"
             mc:Ignorable="d" d:DesignWidth="300" d:DesignHeight="600">

    <ScrollViewer>
        <StackPanel Spacing="10" Margin="10">
            <!-- Brush Settings -->
            <TextBlock Text="Brush Settings" FontWeight="Bold" />
            <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto">
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Radius:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <Slider Grid.Row="0" Grid.Column="1" Value="{Binding BrushRadius}" Minimum="1" Maximum="200" />

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Density Mult:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <Slider Grid.Row="1" Grid.Column="1" Value="{Binding ObjectDensityMultiplier}" Minimum="0.1" Maximum="5.0" />
            </Grid>

            <CheckBox Content="Auto Place Objects" IsChecked="{Binding AutoPlaceObjects}" />

            <!-- Biome Selector -->
            <TextBlock Text="Biome" FontWeight="Bold" Margin="0,10,0,0" />
            <ComboBox ItemsSource="{Binding AvailableBiomes}" SelectedItem="{Binding SelectedBiome}" HorizontalAlignment="Stretch">
                <ComboBox.ItemTemplate>
                    <DataTemplate x:DataType="models:BiomeDefinition">
                        <TextBlock Text="{Binding Name}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <!-- Biome Objects Editor -->
            <TextBlock Text="Objects (Drop assets here)" FontWeight="Bold" Margin="0,10,0,0" />
            <Border BorderBrush="{DynamicResource SystemBaseMediumColor}"
                    BorderThickness="1" CornerRadius="4" Padding="5" MinHeight="150"
                    Background="Transparent"
                    DragDrop.AllowDrop="True"
                    DragDrop.Drop="OnDrop">
                <ScrollViewer MaxHeight="400">
                    <ItemsControl ItemsSource="{Binding SelectedBiome.Objects}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="models:BiomeObject">
                                <Expander HorizontalAlignment="Stretch" Margin="0,0,0,5">
                                    <Expander.Header>
                                        <TextBlock Text="{Binding ObjectId, StringFormat='ID: 0x{0:X8}'}" FontWeight="SemiBold" />
                                    </Expander.Header>
                                    <StackPanel Spacing="5" Margin="5">
                                        <Grid ColumnDefinitions="60,*" RowDefinitions="Auto,Auto,Auto">
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Density:" VerticalAlignment="Center" />
                                            <Slider Grid.Row="0" Grid.Column="1" Value="{Binding Density}" Minimum="0" Maximum="1.0" />

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Scale:" VerticalAlignment="Center" />
                                            <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Spacing="5">
                                                <NumericUpDown Value="{Binding MinScale}" Minimum="0.1" Maximum="10" Increment="0.1" FormatString="F1" Width="70" />
                                                <TextBlock Text="-" VerticalAlignment="Center" />
                                                <NumericUpDown Value="{Binding MaxScale}" Minimum="0.1" Maximum="10" Increment="0.1" FormatString="F1" Width="70" />
                                            </StackPanel>

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Slope:" VerticalAlignment="Center" />
                                            <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Spacing="5">
                                                <NumericUpDown Value="{Binding MinSlope}" Minimum="0" Maximum="90" Increment="1" Width="70" />
                                                <TextBlock Text="-" VerticalAlignment="Center" />
                                                <NumericUpDown Value="{Binding MaxSlope}" Minimum="0" Maximum="90" Increment="1" Width="70" />
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Expander>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
